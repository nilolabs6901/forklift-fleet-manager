<h1 class="h3 mb-4"><%= meta.title %></h1>

<!-- Summary Stats -->
<div class="row g-4 mb-4">
  <div class="col-md-6 col-xl-3">
    <div class="stat-card danger">
      <h3><%= report.summary.criticalCount || 0 %></h3>
      <p>Critical</p>
    </div>
  </div>
  <div class="col-md-6 col-xl-3">
    <div class="stat-card warning">
      <h3><%= report.summary.warningCount || 0 %></h3>
      <p>Warning</p>
    </div>
  </div>
  <div class="col-md-6 col-xl-3">
    <div class="stat-card success">
      <h3><%= report.summary.okCount || 0 %></h3>
      <p>Healthy</p>
    </div>
  </div>
  <div class="col-md-6 col-xl-3">
    <div class="stat-card primary">
      <h3><%= report.summary.unitsWithPredictions || 0 %>/<%= report.summary.totalUnits || 0 %></h3>
      <p>Units Analyzed</p>
    </div>
  </div>
</div>

<!-- Predictions Table -->
<div class="glass-card">
  <div class="card-header">
    <h5><i class="bi bi-cpu me-2"></i>Fleet Predictions</h5>
    <span class="text-muted">Generated <%= new Date(report.generatedAt).toLocaleString() %></span>
  </div>
  <div class="card-body p-0">
    <% if (report.predictions && report.predictions.length > 0) { %>
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Status</th>
            <th>Forklift</th>
            <th>Location</th>
            <th>Top Prediction</th>
            <th>Confidence</th>
            <th>Days Until</th>
            <th>Score</th>
          </tr>
        </thead>
        <tbody>
          <% report.predictions.forEach(pred => { %>
          <% const topPred = pred.predictions && pred.predictions[0] || {}; %>
          <tr>
            <td>
              <span class="badge-status badge-<%= pred.overallStatus || 'ok' %>">
                <%= (pred.overallStatus || 'ok').toUpperCase() %>
              </span>
            </td>
            <td>
              <strong><%= pred.forkliftId %></strong>
              <% if (pred.forkliftModel) { %>
              <br><small class="text-muted"><%= pred.forkliftModel %></small>
              <% } %>
            </td>
            <td><%= pred.location || '-' %></td>
            <td>
              <% if (topPred.title) { %>
              <%= topPred.title %>
              <br><small class="text-muted"><%= topPred.description || '' %></small>
              <% } else { %>
              <span class="text-success">No immediate prediction</span>
              <% } %>
            </td>
            <td><%= topPred.confidence ? topPred.confidence + '%' : '-' %></td>
            <td><%= topPred.daysUntil !== undefined ? topPred.daysUntil + ' days' : '-' %></td>
            <td><strong><%= pred.urgencyScore || 0 %></strong></td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
    <% } else { %>
    <div class="text-center py-5">
      <i class="bi bi-check-circle text-success" style="font-size: 3rem;"></i>
      <h5 class="mt-3">All Systems Normal</h5>
      <p class="text-muted">No critical predictions at this time.</p>
    </div>
    <% } %>
  </div>
</div>

<style>
  .stat-card h3 {
    color: #1e293b;
  }

  .stat-card.danger h3 { color: #dc2626; }
  .stat-card.warning h3 { color: #d97706; }
  .stat-card.success h3 { color: #059669; }
  .stat-card.primary h3 { color: #667eea; }
</style>
